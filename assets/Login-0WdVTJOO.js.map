{"version":3,"file":"Login-0WdVTJOO.js","sources":["../../src/apps/Pages/Login/Login.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { toast, Toaster } from 'sonner';\nimport { motion } from 'framer-motion';\n\nimport { Button } from '@/components/ui/button';\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardHeader, CardTitle, CardFooter } from '@/components/ui/card';\nimport { Icons } from '@/components/icons';\nimport { PasswordInput } from '@/components/PasswordInput';\n\nconst API = import.meta.env.VITE_API_URL;\n\n// âœ… Correct schema: use 'identifier' instead of 'email'\nconst formSchema = z.object({\n  identifier: z.string().min(1, { message: 'Username or Email is required' }),\n  password: z.string().min(1, { message: 'Password is required' }),\n});\n\nexport default function Login() {\n  const [isLoading, setIsLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      identifier: '',\n      password: '',\n    },\n  });\n\n  async function onSubmit(values: z.infer<typeof formSchema>) {\n    setIsLoading(true);\n    try {\n      const response = await axios.post(`${API}/api/auth/login`, {\n        identifier: values.identifier,\n        password: values.password,\n      });\n\n      if (response.data.token) {\n        localStorage.setItem('token', response.data.token);\n\n        // Decode token to get is_admin\n        const payload = JSON.parse(atob(response.data.token.split('.')[1]));\n        const isAdmin = payload.is_admin;\n\n        toast.success('Welcome back, warrior! ðŸ’ª', {\n          description: isAdmin ? 'Admin access granted!' : 'Ready to crush your workout goals?',\n          duration: 3000,\n          position: 'top-center',\n          action: {\n            label: \"Let's Go\",\n            onClick: () => navigate(isAdmin ? '/admin' : '/dashboard'),\n          },\n        });\n\n        await new Promise(resolve => setTimeout(resolve, 1500));\n        navigate(isAdmin ? '/admin' : '/dashboard');\n      }\n    } catch (error: any) {\n      console.error('Login error:', error);\n      if (error.response) {\n        if (error.response.status === 400) {\n          toast.error('Access Denied!', {\n            description: 'Invalid username/email or password.',\n            position: 'top-center',\n          });\n        } else {\n          toast.error('Login Failed!', {\n            description: error.response.data.message || 'Server error.',\n            position: 'top-center',\n          });\n        }\n      } else {\n        toast.error('Connection Error', {\n          description: 'Server is resting. Try again later!',\n          position: 'top-center',\n        });\n      }\n      form.resetField('password');\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center p-4 relative overflow-hidden\">\n      <div className=\"absolute inset-0 z-0\">\n        <img\n          src=\"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80\"\n          alt=\"Gym background\"\n          className=\"w-full h-full object-cover\"\n        />\n        <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\" />\n      </div>\n\n      <Toaster\n        position=\"top-center\"\n        richColors\n        closeButton\n        toastOptions={{\n          classNames: {\n            toast: 'border-0 shadow-lg',\n            title: 'font-bold',\n            description: 'text-sm opacity-90',\n            actionButton: '!bg-primary !text-primary-foreground',\n          },\n        }}\n      />\n\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"w-full max-w-md z-10\"\n      >\n        <Card className=\"w-full border-0 bg-background/90 backdrop-blur-md shadow-xl\">\n          <CardHeader className=\"space-y-1 text-center\">\n            <motion.div\n              className=\"flex justify-center items-center\"\n              initial={{ scale: 0.8 }}\n              animate={{ scale: 1 }}\n              transition={{ type: 'spring', stiffness: 200 }}\n            >\n              <Icons.dumbbell />\n              <span className=\"ml-2 text-2xl font-bold bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent\">\n                FitTrack Pro\n              </span>\n            </motion.div>\n            <CardTitle className=\"text-2xl font-bold mt-4\">Welcome Back, Athlete!</CardTitle>\n            <p className=\"text-sm text-muted-foreground\">\n              Log in to track your workouts and see your gains\n            </p>\n          </CardHeader>\n\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"identifier\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center\">\n                        <Icons.user className=\"w-4 h-4 mr-2\" />\n                        Username or Email\n                      </FormLabel>\n                      <FormControl>\n                        <motion.div whileHover={{ scale: 1.01 }} whileTap={{ scale: 0.98 }}>\n                          <Input\n                            placeholder=\"yourname or your@email.com\"\n                            autoComplete=\"username\"\n                            {...field}\n                            className=\"py-5\"\n                          />\n                        </motion.div>\n                      </FormControl>\n                      <FormMessage className=\"text-xs\" />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"password\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center\">\n                        <Icons.lock className=\"w-4 h-4 mr-2\" />\n                        Password\n                      </FormLabel>\n                      <FormControl>\n                        <motion.div whileHover={{ scale: 1.01 }} whileTap={{ scale: 0.98 }}>\n                          <PasswordInput\n                            placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"\n                            {...field}\n                            className=\"py-5\"\n                          />\n                        </motion.div>\n                      </FormControl>\n                      <FormMessage className=\"text-xs\" />\n                    </FormItem>\n                  )}\n                />\n\n                <motion.div whileHover={{ scale: 1.01 }} whileTap={{ scale: 0.98 }}>\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full py-6 text-lg font-bold bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-lg\"\n                    disabled={isLoading}\n                  >\n                    {isLoading ? (\n                      <>\n                        <Icons.spinner className=\"mr-2 h-5 w-5 animate-spin\" />\n                        Logging in...\n                      </>\n                    ) : (\n                      <>\n                        <Icons.login className=\"w-5 h-5 mr-2\" />\n                        LET'S WORKOUT\n                      </>\n                    )}\n                  </Button>\n                </motion.div>\n              </form>\n            </Form>\n\n            <div className=\"relative my-6\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <span className=\"w-full border-t\" />\n              </div>\n              <div className=\"relative flex justify-center text-xs uppercase\">\n                <span className=\"bg-background/90 px-2 text-muted-foreground\">\n                  Or continue with\n                </span>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <Button variant=\"outline\" className=\"py-5\">\n                <Icons.google className=\"w-5 h-5 mr-2\" />\n                Google\n              </Button>\n              <Button variant=\"outline\" className=\"py-5\">\n                <Icons.apple className=\"w-5 h-5 mr-2\" />\n                Apple\n              </Button>\n            </div>\n          </CardContent>\n\n          <CardFooter className=\"flex flex-col gap-3\">\n            <Button\n              variant=\"link\"\n              className=\"text-sm text-muted-foreground hover:text-primary\"\n              onClick={() => navigate('/reset-password')}\n            >\n              <a href=\"/forgot-password\">Forgot Password?</a>\n            </Button>\n            <div className=\"text-sm text-muted-foreground\">\n              New to FitTrack?{' '}\n              <Button\n                variant=\"link\"\n                className=\"p-0 h-auto text-primary font-bold\"\n                onClick={() => navigate('/signup')}\n              >\n                Join the gains journey\n              </Button>\n            </div>\n          </CardFooter>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n"],"names":["API","formSchema","z.object","z.string","Login","isLoading","setIsLoading","useState","navigate","useNavigate","form","useForm","zodResolver","onSubmit","values","response","axios","isAdmin","toast","resolve","error","jsxs","jsx","Toaster","motion","Card","CardHeader","Icons","CardTitle","CardContent","Form","FormField","field","FormItem","FormLabel","FormControl","Input","FormMessage","PasswordInput","Button","Fragment","CardFooter"],"mappings":"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"}